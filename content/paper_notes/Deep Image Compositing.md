---
title: "Deep Image Compositing"
date: 2021-7-12
draft: false
---

[Question List](../paper_resources/Deep%20Image%20Compositing/Question%20List%2088039fe1ec614558bb654b5491141a56.csv)

# Abstract

- **ç ”ç©¶æƒ…å¢ƒ**
    
    åˆæˆç…§ç‰‡(å¸¸ä½¿ç”¨æ–¼æ›¿æ›èƒŒæ™¯)ï¼Œå°‡ä¸€å€‹è‚–åƒåœ–åˆæˆåœ¨å…¶ä»–èƒŒæ™¯ä¸­
    ä¸¦é æœŸåšåˆ°åˆæˆå“è³ªæ›´å¥½ï¼ˆé‚Šç•Œä¸æ¨¡ç³Šï¼‰çš„åœ–
    
- **éå»å•é¡Œ**
    1.  è€—æ™‚ï¼Œç‚ºç²å¾—é«˜å“è³ªçš„åˆæˆçµæœï¼Œåœ¨ä½¿ç”¨è¤‡é›œçš„å·¥å…·æ™‚é€šå¸¸è¦ç¶“éè¨±å¤šæ­¥é©Ÿæ‰èƒ½å°‡ç…§ç‰‡åˆæˆï¼Œé–€æª»é«˜
        - åˆ†å‰²
        - å»èƒŒ
        - å‰æ™¯å»æ±™
    2.  å…‰æšˆ (åˆæˆé‚Šç•Œæ˜é¡¯)
    3. å‰æ™¯æ±™æŸ“
- **æå‡ºæ–¹æ³•**
    - ä¸éœ€è¦å…¶ä»–ä½¿ç”¨è€…è¼¸å…¥è³‡æ–™å³å¯ç”Ÿæˆé«˜å“è³ªçš„åˆæˆç…§ç‰‡
    - é€²è¡Œ[End-to-end](https://www.itread01.com/content/1546712649.html)è¨“ç·´ï¼Œå„ªåŒ–**ä¸Šä¸‹æ–‡**åŠ**é¡è‰²ä¿¡æ¯**çš„ä½¿ç”¨
    - å¼•å…¥**è‡ªå­¸ç­–ç•¥**ï¼Œç”±æ˜“è‡³é›£é€æ­¥è¨“ç·´ï¼Œæ¸›è¼•è³‡æ–™é›†ä¸è¶³å°è¨“ç·´çš„å½±éŸ¿
    
    <aside>
    ğŸ’¡ åƒè€ƒ[Laplacian pyramid blending (åœ–åƒæ‹‰æ™®æ‹‰çµ²é‡‘å­—å¡”èåˆ)](https://www.gushiciku.cn/pl/gWe0/zh-tw)
    
    </aside>
    
    [[Note][Laplacian pyramid blending](https://www.gushiciku.cn/pl/gWe0/zh-tw)](https://www.notion.so/Note-Laplacian-pyramid-blending-6938543340bb46218cafc61d63d79079?pvs=21)
    
- å¯¦é©—çµæœ
    - å¯è‡ªå‹•ç”Ÿæˆé«˜å“è³ªçš„åˆæˆç…§ç‰‡
    - æ¯”å·²çŸ¥çš„æ‰€æœ‰æ–¹æ³•æ“æœ‰æ›´å¥½çš„**è³ª**èˆ‡**é‡**
    - è³ªå“ªè£¡æ¯”è¼ƒå¥½?
        
        é‚Šç•Œå¹¾ä¹æ²’æœ‰å½å½±ï¼Œç´°ç¯€ä¹Ÿæ¯”è¼ƒæ¸…æ¥šï¼Œå¾PSNRæ¸¬è©¦åŠä½¿ç”¨è€…æ¸¬è©¦ä¸­å¯ä»¥å¾—åˆ°å“è³ªæ¯”è¼ƒå¥½çš„çµè«–
        
    - é‡å“ªè£¡æ¯”è¼ƒå¥½?
        - è¨“ç·´é›†çš„é‡å› ç‚ºæœ‰è‡ªå·±ç™¼æ˜çš„data augmentationæ¼”ç®—æ³•ï¼Œå› æ­¤è¨“ç·´è³‡æ–™è¼ƒå¤š

# 1.Introduction

- ç ”ç©¶å‹•æ©Ÿ
    
    éå»åœ¨åˆæˆåœ–ç‰‡æ™‚ï¼Œè‹¥æƒ³å¾—åˆ°é«˜å“è³ªçš„åˆæˆçµæœé€šå¸¸**è€—æ™‚è€—åŠ›**ä¸”éœ€è¦ä¸€å®šçš„ç¶“é©—èˆ‡æŠ€è¡“ï¼ˆ**é–€æª»é«˜**ï¼‰ï¼Œå› æ­¤æ­¤ç ”ç©¶æå‡ºä¸€å€‹**å…¨è‡ªå‹•ä¸”é«˜å“è³ª**çš„åˆæˆæ©Ÿåˆ¶
    
- éå»ç¶“é©—
    1. æ¡ç”¨salient object segmentation modelåˆ†å‰²å‰æ™¯ï¼Œæœƒæœ‰**å½å½±çš„å•é¡Œ**
        - Whyå½å½±ï¼Ÿ
            
            å› ç‚ºåœ¨é‚Šç•Œèåˆæ™‚ä½¿ç”¨è¼ƒä½éšçš„èåˆæ–¹æ³• e.g.Poissonèåˆï¼ŒLaplacianèåˆï¼Œç¾½åŒ–
            
    2. ç›´è¦ºçš„copy-pastä¸å†é©ç”¨ï¼ˆé‚Šç•Œå•é¡Œï¼‰
        - GT mask
            - **æ¦‚å¿µ**
                - å› æ­¤æœ‰äººæå‡ºå¾å‰æ™¯ä¸­æå–**ç‰©ä»¶é®ç½©**çš„æ¦‚å¿µï¼Œè‘—é‡åœ¨alpha channelï¼ˆé€æ˜åº¦ï¼‰ï¼Œå³ç‚ºGround truth matte
                - åˆ©ç”¨GT matteè¨“ç·´ä¸€å€‹å¯ä»¥é æ¸¬image matteçš„æ¨¡å‹
                    
                    è‹¥æ¨¡å‹é æ¸¬æ¥µç›¡æ­£ç¢ºçš„ç‰©ä»¶é®ç½©ï¼Œå°±å¯ä»¥å”åŠ©åˆæˆåœ–ç‰‡
                    
            - **ç¼ºé»**
                - éœ€è¦äººç‚ºæº–å‚™training dataï¼ˆtrimap: å‰æ™¯ã€å¾Œæ™¯ã€ä¸ç¢ºå®šå€åŸŸï¼‰
                - å„˜ç®¡æœ‰é«˜å“è³ªçš„ç‰©ä»¶é®ç½©ï¼Œåœ¨åˆæˆåœ–ç‰‡**é‚„æ˜¯æœ‰å…‰æšˆå•é¡Œ**
        - Harmonization
            - **æ¦‚å¿µ**
                - æ”¹å–„å‰å¾Œæ™¯èåˆçš„äº¤ç•Œé¡è‰²
            - **ç¼ºé»**
                - éœ€è¦ä½¿ç”¨è€…å…ˆæä¾›ç„¡å…‰æšˆçš„å®Œç¾ç‰©ä»¶é®ç½©æ‰èƒ½é€²è¡Œ
- æå‡ºè§£æ³•
    
    <aside>
    ğŸ’¡ ç›®æ¨™ï¼šçµ¦å®š**ä¸€çµ„å‰æ™¯å’Œå¾Œæ™¯**å³å¯åˆæˆä¸€å¼µä¸éŒ¯çš„åœ–ç‰‡
    
    </aside>
    
    - å…¨è‡ªå‹•çš„end-to-endæ·±åº¦å­¸ç¿’æ¨¡å‹
    - æ–°çš„multi-stream fusionæ¨¡å‹ï¼Œ**å¯ä»¥èåˆä¸åŒå°ºåº¦**çš„åœ–ç‰‡
        
        åœ¨æå–è‚–åƒé®ç½©æ™‚ä½¿ç”¨å…©å€‹network
        
        1. Foreground segmentation network
        2. refinement network
    - æ˜“è‡³é›£çš„data augmentationä¾†å»ºç«‹è‡ªå­¸åˆæˆçš„æ©Ÿåˆ¶

# 2.Related Works

## 2.1. Image Compositing

- **éå»æŠ€è¡“**
    - **è‘—é‡æ–¼å€‹åˆ¥ç¯„ç–‡**
        - image harmonization
        - image matting
        - image blending
    - **ç¶“å…¸çš„åœ–ç‰‡åˆæˆæ–¹æ³• (è‘—é‡æ–¼åˆæˆé‚Šç•Œçš„è™•ç†)**
        1.  Alpha blending
            - æœ€ç°¡å–®ç›´è¦ºçš„æ–¹æ³•
            - ä¾æ“šå‰æ™¯çš„ä¸é€æ˜åº¦åˆæˆèƒŒæ™¯
            - é€ æˆç´°ç¯€æ¨¡ç³Šæˆ–å…‰æšˆå½å½±çš„å•é¡Œ
                
                <aside>
                ğŸ’¡ å…‰æšˆhalo: é€šå¸¸æ˜¯éäººç‚ºé€ æˆçš„åœ–åƒè¼ªå»“å»¶ä¼¸å‡ºç™½è‰²å½±åƒ
                å½å½±artifact: é€šå¸¸æ˜¯å½±åƒåˆæˆçš„éç¨‹é€ æˆçš„èª¤å·®
                
                </aside>
                
        2. Laplacian pyramid blending
            - å¯ä»¥è™•ç†ä¸åŒå°ºå¯¸çš„åœ–ç‰‡èåˆ
            - ä¸åŒscaleæœƒæœ‰ç”šéº¼å•é¡Œ
                1.  æ”¾å¤§ç¸®å°å€æ•¸
- **æå‡ºæŠ€è¡“**
    - å°‡åœ–ç‰‡å’Œæˆçš„å„å€‹ç¯„ç–‡çµ±åˆæˆä¸€å€‹æ¨¡å‹
    - ä¸”ç›®æ¨™æ”¾åœ¨æå‡åˆæˆçš„çµæœæ˜¯å¦æ“¬çœŸ

## 2.2. Data Augmentation

<aside>
ğŸ’¡ æ­¤ç ”ç©¶çš„è³‡æ–™é›†åŒ…å’Œä¸‰ç¨®è³‡æ–™
1. å‰æ™¯ 2. èƒŒæ™¯ 3. åˆæˆçµæœ

</aside>

- å¸¸è¦‹çš„data augmentationæ–¹æ³• ( e.g. å‰ªè£, ç¿»è½‰, é¡è‰²è®Šæ› )ä¸é©ç”¨æ–¼æ­¤ç ”ç©¶çš„è³‡æ–™é›†
    
    å› ç‚ºé‡é»ä¸åœ¨å–®å¼µåœ–çš„å¤šæ¨£åŒ–ï¼Œè€Œæ˜¯ä¸€çµ„ä¸‰å¼µé—œè¯æ€§åœ–çš„ç”Ÿæˆ
    
- æ­¤ç ”ç©¶æå‡ºä¸€å€‹æ–¹æ³•å¯ä»¥è‡ªå‹•ç”Ÿæˆä»¥ **å‰æ™¯ï¼ŒèƒŒæ™¯ï¼Œåˆæˆçµæœ** ä¸€çµ„ç‚ºå–®ä½çš„è³‡æ–™

# 3. Deep Image Compositing

- **è¼¸å…¥**( x2 )ï¼šå‰æ™¯åœ–ã€èƒŒæ™¯åœ–
- è¼¸å‡º ( x1 ) : é«˜å“è³ªåˆæˆåœ–
- **æ•´é«”æ¨¡å‹æ¶æ§‹åœ–**
    
    ![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561.png](../paper_resources/Deep%20Image%20Compositing/Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561.png)
    
    <aside>
    ğŸ’¡ **Segmentation Network + Refinement Network + Multi-stream Fusion Network**
    
    </aside>
    

## 3.1. Multi-stream Fusion Network for Compositing (MLF)

![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561/IMG_464D46507A49-1.jpeg](../paper_resources/Deep%20Image%20Compositing/IMG_464D46507A49-1.jpeg)

- ç¨ç«‹çš„æ¨¡çµ„ 
å¯èˆ‡å…¶ä»–ç¾æˆçš„Segmentation Networkå’Œmatting modeléŠœæ¥ä½¿ç”¨
- ç›®æ¨™ï¼š
    1. å°‡å‰æ™¯åˆ‡å‰²ä¸‹ä¾†èåˆè‡³èƒŒæ™¯åœ–ä¸­ ä¸¦çœ‹èµ·ä¾†è‡ªç„¶
    2. æ¸›å°‘èåˆçš„å‡å½±ï¼ˆé¡è‰²æ±¡æŸ“ç­‰ï¼‰
- åƒè€ƒLaplacian blending methodå¤šå±¤èåˆä¸¦å„ªåŒ–çš„æ¦‚å¿µ
    - å…ƒç´ ï¼š
        - ç·¨ç¢¼å™¨ x2 ( å‰æ™¯/èƒŒæ™¯å„ä¸€å€‹)
        - è§£ç¢¼å™¨ x1 (åˆ†å±¤èåˆ)
        - ç·¨ç¢¼å™¨è§£ç¢¼å™¨æ¶æ§‹
- Loss functioné¸ç”¨
    - L1 losså’Œperceptual loss
    - $L_{all}=L_1+\lambda_PL_P$
    
    [L1 Loss](https://www.notion.so/L1-Loss-38ea268c84454270bb1674ca0e9324b9?pvs=21)
    
    [Perceptual loss](https://www.notion.so/Perceptual-loss-79f80ebbdf0448918d9054fd61d0497b?pvs=21)
    

## 3.2. Segmentation and Mask Refinement Networks

- **Segmentation** 
å¯è¢«æ›¿æ›æˆä¸‹åˆ—model
    - Salient object segmentation model
    - Portrait segmentation model
- **Mask Refinement Network**
    
    <aside>
    ğŸ’¡ ä¸€å€‹å°æ¨¡çµ„ï¼Œå¯¦éš›ä½¿ç”¨æ™‚æ˜¯ç”¨éè¿´çš„æ–¹å¼èµ°å®Œæ•´å¼µå®Œæ•´çš„åœ–
    
    </aside>
    
    - å’ŒSegmentation modelçš„æ¶æ§‹å¤§è‡´æ˜¯ä¸€æ¨£çš„
    - å·®åœ¨æ­¤æ¨¡å‹çš„inputæœ‰RGB-Aå…¶ä¸­çš„Aé€šé“å°±æ˜¯å‰ä¸€å€‹æ¨¡å‹è¼¸å‡ºçš„Raw mask
    - **è¨“ç·´éç¨‹**
        - è¼¸å…¥
            1.  ç¶“**è£å‰ª**å¾Œçš„åœ–ç‰‡
            2. Raw mask
        - è¼¸å‡º
            - ä¸€å€‹ **Local** refined mask
        - è¨“ç·´è³‡æ–™é›†èˆ‡Cross entropy loss functionéƒ½æ˜¯å’ŒSegmentation modelä¸€æ¨£
            - è¨“ç·´çš„æ™‚å€™åŠ å…¥ä¸€äº›è£œä¸è™•ï¼Œè®“æ¨¡å‹èƒ½å°ˆæ³¨æ–¼ç‰¹å®šçš„é»
                - é‚£äº›ç‰¹å®šçš„é»?
    - **æ¸¬è©¦éç¨‹**
        - è¼¸å…¥ç‚ºæ•´å¼µå®Œæ•´çš„åœ–ä»¥åŠå…¶Raw mask
    - **å¯¦ä½œéƒ¨åˆ†  å…©éšæ®µæ¶æ§‹**
        - ç¬¬ä¸€éšæ®µ
            - å°‡åŸå§‹åœ–ç‰‡åŠå…¶Raw maskè¨­ç‚º$320 \times320$
            - ç”Ÿæˆæ­¤è§£æåº¦çš„Refine mask
        - ç¬¬äºŒéšæ®µ
            - å°‡åŸå§‹åœ–ç‰‡resizeç‚º$640 \times640$
            - Upsampleå‰ä¸€å€‹éšæ®µçš„refine maskè‡³$640 \times640$
            - å†ç”Ÿæˆä¸€å€‹æ­¤è§£æåº¦çš„raw mask

# 4. Easy-to-Hard Data Augmentation

<aside>
ğŸ’¡ MLF çš„è¨“ç·´è³‡æ–™é›†æ˜¯ç”±è¨±å¤š $[FG,\ BG, \ C]$ æ‰€çµ„æˆï¼Œå› æ­¤åœ¨æ­¤æƒ…å¢ƒä¸‹å‚³çµ±çš„data augmentationä¸¦æ²’æœ‰ç”¨ï¼Œå› æ­¤ä»–æå‡ºä¸€å€‹æ–°çš„data augmentationæ–¹æ³•ä¾†å¢åŠ è³‡æ–™é›†

</aside>

ğŸ”‘   å–„ç”¨å·²è¨“ç·´å¥½çš„æ¨¡å‹è‡ªè¡Œç”Ÿæˆæ›´å¤šè³‡æ–™

- **MLF æ¨¡å‹è¨“ç·´éç¨‹**
    - **ç¬¬ä¸€éšæ®µ**
        - **é è™•ç†**
            1. ç°¡å–®çš„å‰æ™¯åœ–ï¼ˆé€éDeep Image Mattingç™¼è¡¨çš„mattingæ–¹æ³•ä¾†å–å¾—matï¼‰
            2. ä¸Šç¶²æŠ“èƒŒæ™¯åœ–
            3. **æ‰‹å‹•**å°‡å‰èƒŒæ™¯åœ–èåˆï¼ˆå–„ç”¨alpha channelçš„è³‡è¨Šï¼‰
                
                ![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561/GenerateEasyTrainingTriplet.png](../paper_resources/Deep%20Image%20Compositing/GenerateEasyTrainingTriplet.png)
                
        - **è¨“ç·´**
            
            ![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561/traingingMLF_v1.png](../paper_resources/Deep%20Image%20Compositing/traingingMLF_v1.png)
            
        - æ¨¡å‹ç›®å‰èƒ½åŠ›ï¼šå¯ä»¥èåˆ**ç°¡å–®çš„å‰æ™¯**èˆ‡**éš¨æ©ŸèƒŒæ™¯**
    - **ç¬¬äºŒéšæ®µ**
        - **é è™•ç†**
            1. ç°¡å–®çš„èƒŒæ™¯åœ–ï¼ˆä¸Šç¶²ä»»æ„æŠ“ï¼‰
            2. ä¸Šç¶²æŠ“èƒŒæ™¯åœ–
            3. ä½¿ç”¨ç¬¬ä¸€å€‹ç‰ˆæœ¬çš„**MLFç”Ÿæˆ**ä¹‹å¾Œè¨“ç·´æ‰€éœ€çš„è³‡æ–™é›†
            4. $C'=EasyFG\oplus BG2=FG'\oplus BG'$
            
            ![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561/IMG_031733EEBB19-1.jpeg](../paper_resources/Deep%20Image%20Compositing/IMG_031733EEBB19-1.jpeg)
            
        - æ¨¡å‹ç›®å‰èƒ½åŠ›ï¼šå¯ä»¥èåˆè¤‡é›œå‰æ™¯èˆ‡éš¨æ©ŸèƒŒæ™¯
            
            ![Deep%20Image%20Compositing%2042fb3e698f074a26b56d2a019b452561/trainingMLF_v2.png](../paper_resources/Deep%20Image%20Compositing/trainingMLF_v2.png)
            

# 5. Experiments

- è©•åƒ¹æ­¤MLFæ¶æ§‹çš„è§’åº¦
    - **çµæœ**
        1. å®šé‡åˆ†æ (PSNRå®¢è§€æ•¸å€¼)
        2. æ„ŸçŸ¥è©•åƒ¹ (è¦–è¦ºä¸Šæ„Ÿå—)
            - åƒèˆ‡è©•æ¯”çš„æ–¹æ³•
                1. Laplacian Pyramid Blending
                2. Matting based
                3. Information-flow
                4. DIM
                5. Index-net
                6. MLFçš„Sigle-streamç‰ˆ
            1. å—æ¸¬è€…44ä½
            2. 14çµ„æ¸¬è©¦è³‡æ–™
                - å„çµ„2å¼µç…§ç‰‡
                    1. å‰æ™¯ 
                    2. èåˆæˆæœ
                - æ¯çµ„éƒ½æœ‰æ‰€æœ‰æ¯”è¼ƒæ–¹æ³•çš„çµæœ
            3. å—æ¸¬è€…åœ¨æ¯çµ„æ¸¬è³‡ä¸­é¸å‡ºå‰ä¸‰åå–œæ­¡çš„çµæœ(ä¾åºçµ¦1-3, å…¶é¤˜çš†çµ¦8)
    - **æ¶æ§‹**
        1. ç°¡åŒ–æ¶æ§‹
- ä¸»è¦æ¯”è¼ƒæ–¹æ³•
    - Laplacian pyramid blending å‚³çµ±æ··åˆæ³•(éåŸºæ–¼matting)
    - Closed-Form Matting based
    - KNN  Matting based
    - Information-flow  Matting based
    - Deep Image Matting  Matting based
    - Index-net  Matting based
    - Copy-past Baseline
- è³‡æ–™é›†ä¾†æº
    - Segmentationå’ŒRefinement network
        - **DUTS (**10553+ 5019å¼µ)
            - å…±10553å¼µ
            - å…©å€‹è³‡æ–™å¤¾(åˆ†åˆ¥ç‚º**åŸå§‹åœ–**èˆ‡å…¶**å°æ‡‰é®ç½©**)
            
            [The DUTS Image Dataset](http://saliencydetection.net/duts/#org0602ffb)
            
        - **MSRA-10K** (10000å¼µ)
            
            [MSRA10K Salient Object Database](https://mmcheng.net/msra10k/)
            
        - **Portrait segmentation** (4632å¼µ)
            - **Deep Automatic Portrait Matting** (1700+300å¼µ)
                
                [Deep Automatic Portrait Matting](http://xiaoyongshen.me/webpages/webpage_automatting/)
                
            - **Automatic portrait segmentation for image stylization** (2632å¼µ)
    - Multi-fusion compositing network
        - Training
            - matting-based åˆæˆè³‡æ–™é›†(æ‰‹å‹•)
                - 30000å¼µåœ–
                - ä½¿ç”¨GTé®ç½©ä¾†åˆæˆå‰æ™¯èˆ‡èƒŒæ™¯
            - self-taught data augmentationè³‡æ–™é›†(è‡ªå‹•)
        - Testing
            - SynTest
                
                ä½¿ç”¨self-taught data augmentationç”Ÿæˆçš„æ¸¬è©¦è³‡æ–™
                
- å¯¦ä½œç´°ç¯€
    - Segmentationå’ŒRefinement network
        - Input size: $256 \times 256$
        - Adamæ›´æ–°æ–¹æ³•learning rateç‚º$2\times 10^{-3}$
        - batch size: 8
    - Multi-fusion compositing network
        - Input size:
            - Training: $384 \times 384$
            - Testing: $768 \times 768$
        - Adamæ›´æ–°æ–¹æ³•learning rateç‚º$2\times 10^{-3}$
        - batch size: 8
        - iteration: 200000
        - $L_{all}=L_1+$$0.8$$L_P$
            
            $L_{all}=L_1+\lambda_PL_P$
            

## 5.1. Results

èåˆå“è³ªçš„è©•ä¼°ä¸»è¦ç”±å…©å€‹å±¤é¢

1. **PSNR(å®¢è§€æ•¸å€¼æ•¸æ“šæ¯”è¼ƒ)**
    - **ä»€éº¼æ˜¯PSNR(å³°å€¼è¨Šå™ªæ¯”)**
        
        Peak signal-to-noise ratio
        
        - æ‹¿åŸå§‹åœ–$I$èˆ‡å£“ç¸®åœ–$K$é€²è¡Œæ¯”è¼ƒ
        - ä½¿ç”¨MSEå‡æ–¹å·®é€²è¡Œå®šç¾©
            
            $MSE=\frac{1}{mn}\sum_{i=0}^{m-1}\sum_{j=0}^{n-1}[I(i,j)-K(i,j)]^2$
            
            $PSNR=20\cdot\log_{10}(\frac{MAX_I}{\sqrt{MSE}})$
            $PSNR_{RGB}=10\cdot\log_{10}(\frac{MAX_I^2}{\frac{1}{3mn}\sum_{R,G,B}\sum_{i=0}^{m-1}\sum_{j=0}^{n-1}[I_{color}(i,j)-K_{color}(i,j)]^2})$
            
        - è©•åˆ†æ¨™æº–
            - PSNRæ¥è¿‘ 50dB ï¼Œä»£è¡¨å£“ç¸®å¾Œçš„åœ–åƒåƒ…æœ‰äº›è¨±éå¸¸å°çš„èª¤å·®ã€‚
            - PSNRå¤§æ–¼ 30dB ï¼Œäººçœ¼å¾ˆé›£å¯Ÿè¦ºå£“ç¸®å¾Œå’ŒåŸå§‹å½±åƒçš„å·®ç•°ã€‚
            - PSNRä»‹æ–¼ 20dB åˆ° 30dB ä¹‹é–“ï¼Œäººçœ¼å°±å¯ä»¥å¯Ÿè¦ºå‡ºåœ–åƒçš„å·®ç•°ã€‚
            - PSNRä»‹æ–¼ 10dB åˆ° 20dB ä¹‹é–“ï¼Œäººçœ¼é‚„æ˜¯å¯ä»¥ç”¨è‚‰çœ¼çœ‹å‡ºé€™å€‹åœ–åƒåŸå§‹çš„çµæ§‹ï¼Œä¸”ç›´è§€ä¸Šæœƒåˆ¤æ–·å…©å¼µåœ–åƒä¸å­˜åœ¨å¾ˆå¤§çš„å·®ç•°ã€‚
            - PSNRä½æ–¼ 10dBï¼Œäººé¡å¾ˆé›£ç”¨è‚‰çœ¼å»åˆ¤æ–·å…©å€‹åœ–åƒæ˜¯å¦ç‚ºç›¸åŒï¼Œä¸€å€‹åœ–åƒæ˜¯å¦ç‚ºå¦ä¸€å€‹åœ–åƒçš„å£“ç¸®çµæœã€‚
    - **å„æ–¹æ³•æ¯”è¼ƒçµæœ**
        - ç¾½åŒ–å’ŒLaplacian pyramidæ–¹æ³•
            1. æ¨¡ç³Šé‚Šç•Œ
            2. é çœ‹æ•ˆæœé‚„ä¸éŒ¯ï¼Œè¿‘çœ‹ç´°ç¯€æ¶ˆå¤±å¤ªå¤š
            3. æœƒæœ‰å…‰æšˆå‡å½±ï¼ˆç³ŠåŒ–çš„é—œä¿‚ï¼‰
        - é®ç½©ç›¸é—œæ–¹æ³•
            1. ç´°ç¯€é‚„ä¸éŒ¯
            2. åˆæˆå“è³ªå¥½å£é«˜åº¦ä¾è³´é®ç½©çš„å®Œæ•´åº¦
        - æœ¬ç ”ç©¶æ–¹æ³•
            1. é®ç½©å®¹éŒ¯ç‡é«˜(segmentation modelè‹¥åˆ‡å‰²çš„ä¸æ˜¯å¾ˆå®Œç¾é‚„æ˜¯æœƒæœ‰refine networkè£œæ•‘)
            2. é‚Šç•Œç´°ç¯€ä¿ç•™æœ€å®Œæ•´(å› ç‚ºé®ç½©æœ‰refineé)
            3. è£œè¶³matteä¸è¶³çš„éƒ¨åˆ†
2. **äººç‚ºä¸»è§€æ¸¬è©¦**
    - ç¸½å…±44ä½å—æ¸¬è€…
    - æ¯äººæ¸¬è©¦14çµ„åˆæˆåœ–ç‰‡
    - è¦å‰‡
    å—æ¸¬è€…åœ¨æ¯çµ„æ¸¬è©¦åœ–ç‰‡ä¸­é¸å‡ºæœ€å–œæ­¡çš„å‰ä¸‰åä¸¦çµ¦äºˆ1-3åˆ†(è¶Šä½è¶Šå¥½)ï¼Œå…¶é¤˜ç›´æ¥çµ¦8
    - å¿…è¼ƒçµæœ
        1. æœ¬ç ”ç©¶æ–¹æ³•
        9/14ä¸­æ’åç¬¬ä¸€
        2. Index-net
        4/14ä¸­æ’åç¬¬ä¸€
        3. DIM
        1/14ä¸­æ’åç¬¬ä¸€
        
        <aside>
        ğŸ’¡ å—æ¸¬è€…åèª¤ï¼šåœ¨**é‚Šç•Œç´°ç¯€æ¸…æ¥šä½†é›œè¨Šå¾ˆå¤š**èˆ‡**é‚Šç•Œæ¨¡ç³Š**çš„åœ–ç‰‡ä¸­ï¼Œäººç‚ºæœƒé¸æ“‡å¾Œè€…
        
        </aside>
        

## 5.2. Ablation Study

ç‚ºäº†æª¢æ¸¬MLFæ•´é«”æ¶æ§‹çš„å¿…è¦æ€§èˆ‡æ•ˆèƒ½ï¼Œåœ¨æ­¤éƒ¨åˆ†å˜—è©¦å°‡MLFèˆ‡æŠ½æ‰éƒ¨åˆ†æ¶æ§‹çš„MLFé€²è¡Œçµæœæ¯”è¼ƒ

- **Data augmentation**
    - é‡æ–°è¨“ç·´MLFæ¨¡å‹ï¼Œä½†è¨“**ç·´è³‡æ–™åƒ…æœ‰åŸæœ¬ä½¿ç”¨matting-basedåˆæˆçš„æ¸¬è³‡**
    - è¨“ç·´è³‡æ–™æ˜é¡¯ä¸è¶³ï¼Œé€ æˆåˆæˆå¾Œçš„å‰æ™¯å¯èƒ½æœƒæ··åˆ°èƒŒæ™¯çš„é¡è‰²
- **Two-stream**
    - æ‹¿æ‰å‰èƒŒæ™¯å„ä¸€å€‹encoder-decoderçš„æ¶æ§‹ï¼Œè€Œæ˜¯å°‡å‰æ™¯ã€èƒŒæ™¯ã€é®ç½©å…¨éƒ¨é€£æ¥å†ä¸€èµ·ç•¶ä½œè¼¸å…¥ï¼Œä¸¦èª¿æ•´åƒæ•¸é‡å‹é‡èˆ‡ä¹‹å‰çš„ç›¸ç¬¦
    - é€ æˆå‰æ™¯å°éƒ¨åˆ†éºå¤±åŠé‚Šç•Œå‡å½±è¼ƒç‚ºæ˜é¡¯
- **Mask-refinement**
    - Segmentation networkç”¢å‡ºçš„matteä¸é€²è¡Œrefineï¼Œç›´æ¥ä½¿ç”¨raw matteé€²è¡Œåˆæˆ
    - åˆæˆå¾Œçš„ç‰©ä»¶é‚Šç•Œæœƒæ®˜ç•™äº›è¨±èˆŠèƒŒæ™¯çš„é¡è‰²(é®ç½©èª¤å·®)

# 6. Conclusion

- End-to-endåœ–ç‰‡èåˆæ¶æ§‹
- Multi-stream fusionç¶²è·¯
- è‡ªå­¸çš„data-augmentationæ¼”ç®—æ³•

<aside>
ğŸ’¡ MLFæ•ˆæœé›–ç„¶ä¸éŒ¯ä½†ä»ä¸å®Œç¾ï¼Œç•¶segmentationæ•ˆèƒ½ä¸å¥½ï¼ˆç„¡æ³•æº–ç¢ºåœ°åˆ‡å‰²å‡ºå‰æ™¯æ™‚ï¼‰ï¼ŒMLFçš„æ•ˆèƒ½å°±æœƒæ˜é¡¯è¢«å½±éŸ¿

</aside>

# More Reference

- Deep Image Matting
    
    [](https://arxiv.org/pdf/1703.03872.pdf)