---
title: "Incremental Transformer Structure Enhanced Image Inpainting with Masking Positional Encoding"
date: 2022-8-9
draft: false
---

# Abstract

# 1. Introduction

- Inpaintingçš„é‡é»
    - coherent texture
    - visually reasonable structures
- éå»çš„Inpaintingæ–¹æ³•æœ‰4å¤§å•é¡Œ
    1. æ„Ÿå—é‡éå°ï¼šCNN kernelçš„é—œä¿‚ï¼Œå°±ç®—æ˜¯dilated CNNä¹Ÿæœƒåœ¨åœ¨éå¤§çš„æ¯€æå€åŸŸæˆ–é«˜è§£æåº¦çš„æƒ…å¢ƒä¸‹é™ä½æ•ˆèƒ½
    2. éºå¤±æ•´é«”çš„çµæ§‹ï¼šè‹¥æ¨¡å‹ä¸äº†è§£æ•´é«”çš„çµæ§‹ï¼Œå‰‡å¾ˆé›£é‚„åŸç´°ç¯€
    3. è¨ˆç®—é‡é‡ï¼šè¨“ç·´GANå°å¤§å½±åƒçš„é‚„åŸæ˜¯å›°é›£ä¸”è€—è²»è³‡æºçš„ï¼Œä¸”æ•ˆèƒ½æœƒéš¨è‘—å½±åƒè§£æåº¦æé«˜è€Œé™ä½
    4. é®ç½©å€åŸŸæ²’æœ‰ä½ç½®è³‡è¨Šï¼šæ¨¡å‹å®¹æ˜“åœ¨éºå¤±å€åŸŸç”¢ç”Ÿå½å½±

# 2. Related work

# 3. Method

![æˆªåœ– 2022-08-22 ä¸‹åˆ3.32.31.png](./ZITS/2022-08-22_3.32.31.png)

### ç°¡å¯«èªªæ˜

- **ZITS :** ZeroRA based Incremental Transformer Structure
- **MPE :** Masking Positional Encoding
- **TSR :** Transformer Structure Restorer
- **FTR :** Fourier CNN Texture Restoration

### Overview

1. Structure restoration
    1. è¼¸å…¥ç‚º$TSR(I_m, I_e, I_l, M)$
        1. $I_m:$ è¢«é®ç½©çš„è¼¸å…¥å½±åƒ
        2. $I_e:$ é‚Šç·£è³‡è¨Š
        3. $I_l:$ ç·šæ¢è³‡è¨Š
        4. $M:$ äºŒå…ƒmask
    2. è¼¸å‡ºç‚ºè‰åœ–åŸŸ $[\tilde{I_e}, \tilde{I_l}]=TSR(I_m, I_e, I_l, M)$
2. Simple Structure upsample
    1. åœ¨æ¨è«–æœŸé–“æœƒä½¿ç”¨SSUä¾†å°‡ç°éšçš„è‰åœ–ä¸Šæ¡æ¨£è‡³ä»»æ„å¤§å°
3. Extract structure feature
    1. åœ¨ä½¿ç”¨ä¸€å€‹gated convolution based SFEä¾†æå–å¤šå°ºåº¦çš„ç‰¹å¾µ
    $S_k=SFE(\tilde{I_e}, \tilde{I_l},M), \{k=0,1,2,3\}$
4. Add to to the fourier CNN texture restoration
    1. å°‡$S_k$è³‡è¨Šé€æ­¥åŠ å…¥(ZeroRA)ç›¸å°æ‡‰çš„FTR layerä¸­

## 3.1 Transformer Structure Restoration

- transformerå…·æœ‰å›å¾©å…¨å±€è³‡è¨Šçš„èƒ½åŠ›
- é™¤äº†ä½¿ç”¨åŸå§‹çš„attention moduleä¾†æå–å…¨åŸŸç›¸é—œæ€§å¤–ï¼Œæ›´æé™¤äº†ç°¡åŒ–è¨ˆç®—çš„RPE based axial attention module

### ä½¿ç”¨æ­¥é©Ÿ

1. å°‡åŸå§‹å¤§å°ç‚º$256\times256çš„$è¼¸å…¥ï¼šé®ç½©å¾Œ å½±åƒ$I_m$ã€é‚Šç·šå½±åƒ $I_e$ã€ç·šæ¢å½±åƒ$I_l$å’Œé®ç½©$M$ï¼Œé€éä¸‰å€‹å·ç©ä¾†downsampling
2. åœ¨å¾—å‡ºçš„ç‰¹å¾µä¸Šç–ŠåŠ ä¸Šçµ•å°ä½ç½®çš„position embeddingï¼Œ$X\in \mathbb{R}^{h\times w\times c}$ï¼Œ$h,w=32$ and $c=256$
3. ä½¿ç”¨axial attentionä¾†å–ä»£åŸå§‹attentionçš„é¾å¤§è¨ˆç®—ï¼Œä¸¦ä¸”åœ¨æ¯å€‹axial attention æ¨¡çµ„ä¸­ä¹Ÿæ³¨å…¥RPE(relative position encoding)ä¾†åŠ å¼·è¡¨ç¤ºç©ºé–“ä¸­çš„é—œä¿‚
    
    ![æˆªåœ– 2022-08-31 ä¸‹åˆ9.22.19.png](./ZITS/2022-08-31_9.22.19.png)
    
    $W_{rq}, W_{rk}, W_{cq}, W_{ck}$æ˜¯å¯è¨“ç·´çš„åƒæ•¸ï¼Œç‚ºattentionä¹‹ç”¨çš„queryå’Œkey
    $R^{row}_{i,j}$æ˜¯row $i$å’Œ$j$çš„RPEå€¼
    
4. ç¶“ä¸Šè¿°ä¸€é€£ä¸²çš„attentionè¨ˆç®—å¾Œï¼Œåœ¨ä½¿ç”¨ä¸‰å€‹è½‰ç½®å·ç©ä¾†å›å¾©æˆåŸå§‹å¤§å°$256\times256$

<aside>
ğŸ’¡ ä½¿ç”¨binary cross entropy(BCE)ä¾†è¨ˆç®—é æ¸¬å‡ºçš„è‰åœ–çµæ§‹$\tilde{I_e}$å’Œ$\tilde{I_l}$
$L_e=BCE(\tilde{I_e},\hat{I_e}),\ L_l=BCE(\tilde{I_l},\hat{I_l})$

</aside>

![æˆªåœ– 2022-08-31 ä¸‹åˆ9.39.32.png](./ZITS/2022-08-31_9.39.32.png)

## 3.2 Simple Structure Upsampler

<aside>
ğŸ’¡ ç‚ºäº†ç”¢ç”Ÿæ›´é«˜ç•«ç´ çš„æ¢å¾©åœ–ï¼Œéœ€è¦æœ‰å¯ä¾è³´é«˜çš„**é‚Šç·£/ç·šæ¢**åœ–

</aside>

![æˆªåœ– 2022-08-31 ä¸‹åˆ9.39.45.png](./ZITS/2022-08-31_9.39.45.png)

- åŸå§‹çš„æ’å€¼æ³•upsamplingæœƒç”¢ç”Ÿé‹¸é½’ç‹€çš„å•é¡Œï¼Œåœ–(f)-(i)
- å¹¸é‹çš„æ˜¯è‰åœ–çš„ä¸Šæ¡æ¨£å¯ä»¥é€éå­¸ç¿’çš„æ–¹æ³•ä¾†é”æˆ
    - åŸæœ¬ä½¿ç”¨é‚Šç·£è‰åœ–å’Œç·šæ¢è‰åœ–ä¸€èµ·è¨“ç·´æ­¤upsamplingæ¨¡å‹ï¼Œä½†ç™¼ç¾é‚Šç·£è‰åœ–åœ¨ä¸åŒçš„è§£æåº¦ä¸‹æœ‰ä¸ä¸€æ¨£çš„å‘ˆç¾æ–¹æ³•ï¼Œå› æ­¤å­˜åœ¨æ­§ç•°ï¼Œå°è‡´è¨“ç·´å‡ºä¾†çš„æ¨¡å‹ç„¡æ³•æ­£ç¢ºçš„upsampleé‚Šç·£åœ–ï¼ˆå¦‚åœ–jï¼‰
    - ä½†ç·šæ¢åœ–çš„ç‰¹æ€§ç›¸å°æ¸…æ¥šä¸”åœ¨ä»»æ„è§£æåº¦ä¸‹çš„æ¨£å­éƒ½ä¸€æ¨£ï¼Œå› æ­¤ä½œè€…ç™¼ç¾åªæ‹¿ç·šæ¢è‰åœ–ä¾†è¨“ç·´upsampleæ¨¡å‹çš„æ•ˆæœè¼ƒå¥½ï¼Œæ”¾å¤§çš„è‰åœ–å¦‚åœ–(k)

## 3.3 ZeroRA Structure Enhanced Inpainting

![æˆªåœ– 2022-08-31 ä¸‹åˆ9.48.13.png](./ZITS/2022-08-31_9.48.13.png)

### Fourier CNN Texture Restoration (FTR)

<aside>
ğŸ’¡ ä¸»è¦æ˜¯ç”¨ä¾†æ¢å¾©ç´‹ç†ï¼Œç‚ºæ­¤ç¯‡è«–æ–‡çš„æ–¹æ³•éª¨å¹¹

</aside>

- FTRçš„é—œéµåœ¨æ–¼FFCå±¤ï¼ˆå¿«é€Ÿå‚…ç«‹è‘‰å·ç©å±¤ï¼‰ï¼Œæœ‰å…©å€‹åˆ†æ”¯çµ„æˆ
    1. å±€éƒ¨åˆ†ä¹‹ä½¿ç”¨å¸¸æ…‹å·ç©
    2. å…¨å±€åˆ†æ”¯åœ¨å¿«é€Ÿå‚…ç«‹è‘‰è®Šæ›å¾Œå°ç‰¹å¾µé€²è¡Œå·ç©
- åœ¨ä¿®å¾©çš„éç¨‹ä¸­å°‡å…©å€‹åˆ†æ”¯çš„è³‡è¨Šçµ„åˆèµ·ä¾†ç²å¾—æ›´å¤§çš„**æ„Ÿå—é‡**èˆ‡**å±€éƒ¨ä¸è®Šæ€§**
- æ­¤å¼·å¤§çš„æ–¹æ³•é›–ç„¶å°æ¢å¾©ç´‹ç†å¾ˆæœ‰ç”¨ï¼Œä½†å°æ–¼åœ¨**é‡å»ºæ•´é«”çµæ§‹æ˜¯æœ‰å¼±å‹¢çš„**ï¼Œå› æ­¤æ­¤ç¯‡è«–æ–‡æå‡ºä¸€ç³»åˆ—æ–°ç©çš„çµ„ä»¶ä¾†æ”¹å–„å®ƒ

[ã€multi-scaleç³»åˆ—ã€‘é¢‘åŸŸå·ç§¯ Fast Fourier Convolutionï¼ˆNeurIPS 2020ï¼‰](https://zhuanlan.zhihu.com/p/358187931)

### Structure Feature Encoder (SFE)

<aside>
ğŸ’¡ æ­¤æ¨¡çµ„æ˜¯ç‚ºäº†å°‡**é‚Šç·£åœ–**èˆ‡**ç·šæ¢åœ–**è½‰æˆç‰¹å¾µåœ–

</aside>

- éœ€è¦FCN (Full convolution network)
- æ­¤è«–å•ä¸­çš„SFEæ˜¯ä¸€å€‹è‡ªå‹•ç·¨ç¢¼å™¨æ¨¡å‹
    - ä¸‰å±¤çš„downsamplingå·ç©â†’encoder
    - ä¸‰å±¤çš„residual blocks with dilated å·ç© â†’ middle
    - ä¸‰å±¤çš„upsampling å·ç©â†’decoder
- SFEä¸­çš„encoderå’Œdecoderéƒ½æ˜¯gated convolutions(GCs)
    - gated convolutioné€šå¸¸æ˜¯ç”¨ä¾†è®“æ¨¡å‹è‘—é‡åœ¨é‡é»å€åŸŸçš„ç‰¹å¾µï¼Œé©ç”¨ä¸è¦å‰‡å½¢ç‹€çš„é®ç½©
    - gated convolutionçš„æ¦‚å¿µæ˜¯å¦å¤–åœ¨å­¸ä¸€å€‹sigmoidç‰¹å¾µï¼Œæ­¤ç‰¹å¾µæœ‰é»åƒweightingçš„æ¦‚å¿µï¼Œå¯ä»¥è¡¨é”å“ªä¸€å€åŸŸçš„ç‰¹å¾µè¼ƒç‚ºé‡è¦ä¸¦ä¸”ä¿ç•™
- åœ¨é€™éƒ¨åˆ†SFEçµæŸå¾Œæœƒå¾—åˆ°ç‰¹å¾µç©ºé–“ä¸‹çš„é‚Šç·£åœ–å’Œç·šæ¢åœ–è³‡è¨Šï¼Œä¸”å·²ç¶“ç¶“ééæ¿¾ï¼Œåªä¿ç•™é‡é»å€åŸŸçš„è³‡è¨Šï¼Œå› ç‚ºç°éšçš„è‰åœ–è³‡è¨Šå¾ˆç–æ•£ï¼Œå†é€è‡³FTR
- æœ€å¾Œæœƒå¾—åˆ°å››å€‹coarse-to-fineçš„ç‰¹å¾µåœ–$S_k, k=\{0,1,2,3\}$
    - æœ€å¾Œä¸€å±¤middleåŠ ä¸Šä¸‰å±¤decoderâ†’æ­¤å››å¼µç‰¹å¾µåœ–ä»£è¡¨è½‰æ›å¾Œçš„çµæ§‹æ€§ç‰¹å¾µ
    - $S_0, S_1, S_2, S_3=SFE(\tilde{I_e}, \tilde{I_l},M)$
    - $M$ ç‚ºresizedçš„binary mask

### Masking Positional Encoding (MPE)

- **ç‚ºä»€éº¼éœ€è¦masking positional encoding?**
    - åœ¨CNNé‹ç®—ä¸­ï¼Œpaddingå¯ä»¥æä¸­ä¸€äº›ä½ç½®è³‡è¨Šï¼Œä½†åªåŒ…å«äº†spatial anchorsï¼Œ**å¤§éƒ¨åˆ†åªèƒ½è­˜åˆ¥è§’è½æˆ–é‚Šç•Œçš„è³‡è¨Š**
    - é è¿‘é‚Šç•Œçš„éƒ¨åˆ†æ“æœ‰è¼ƒå¤šçš„ä½ç½®è³‡è¨Šï¼Œå› æ­¤GANåœ¨ç”Ÿæˆçš„æ™‚å€™èƒ½å¤ æœ‰æ¯”è¼ƒæ˜ç¢ºçš„ç›®æ¨™ï¼Œåä¹‹é è¿‘ä¸­å¿ƒé»çš„éƒ¨åˆ†å‰‡å®¹æ˜“ç”¢ç”Ÿå½å½±
    â†’ GANåœ¨è³‡è¨Š(specific position encoding)ä¸è¶³çš„å€åŸŸå®¹æ˜“ç”¢ç”Ÿé‡è¤‡æ€§ç„¡æ„ç¾©çš„artifacts
    - åœ¨ä¿®å¾©éç¨‹ä¸­ï¼Œæœªå±è”½çš„å€åŸŸä¸éœ€è¦ä½ç½®è¨Šæ¯ï¼Œç”šè‡³å¯ä»¥èªªä¸ç”¨ç®¡ä»–ï¼Œå› ç‚ºæ¨¡å‹æ°¸é æœƒçŸ¥é“ç‚ºå±è”½å€åŸŸçš„æ¨™æº–ç­”æ¡ˆï¼Œä½†**è¢«å±è”½å€åŸŸçš„ä½ç½®è³‡è¨Šå°±å¾ˆé‡è¦äº†**
    - å—é™æ–¼CNNçš„æ„Ÿå—é‡ï¼Œç•¶maskéå¤§æ™‚æ¨¡å‹å¯èƒ½æœƒå¤±å»æ–¹å‘å’Œä½ç½®ä¿¡æ¯ï¼Œå› æ­¤å¦‚æœæœ‰maskingçš„positional encodingè³‡è¨Šè¼”åŠ©çš„è©±ï¼Œå°±å¯èƒ½å¯ä»¥æ¸›å°‘ç„¡æ„ç¾©çš„å½å½±ç”¢ç”Ÿ
    - é›–ç„¶FFCå¯ä»¥å°‡ç‰¹å¾µå­¸ç¿’è½‰ç§»åˆ°é »åŸŸä¸Šï¼Œç„¡æ³•æ˜ç¢ºå€åˆ†å±è”½å€åŸŸå’Œæœªå±è”½å€åŸŸï¼Œå› æ­¤æ­¤ç¯‡è«–æ–‡åœ¨FFCä¸ŠåŠ ä¸ŠMPEçš„æ–°æ¨¡çµ„ä¾†è¼”åŠ©æä¾›é®è”½å€åŸŸçš„ä½ç½®è³‡è¨Š

- **MPEçš„é‹ä½œé‚è¼¯**
    - $P$ä»£è¡¨masked and unmasked positional relations
        - $P_{dis}$ ä»£è¡¨masking distance
        - $P_{dir}$ ä»£è¡¨masking directions
    - æ­¥é©Ÿ
        1. å…ˆçµ¦å®šä¸€å€‹inverseçš„$256\times256$çš„é®ç½©
            1. 1â†’ç‚ºé®ç½©å€åŸŸ
            2. 0â†’å±è”½å€åŸŸ
        2. ä½¿ç”¨ä¸€å€‹$3\times3$çš„all-oneæ ¸å¿ƒé‚„è¨ˆç®—å„å€‹ä½ç½®çš„maskingçš„è·é›¢
        3. ä½¿ç”¨sinusoidal positional encodingä¾†å¾—åˆ°$P_{dis}\in\mathbb{R}^{256\times256\times d}$
        æ­¤$d$ å°æ‡‰åˆ°FTRçš„ç¬¬ä¸€å€‹å·ç©çš„æ·±åº¦(channel size)ï¼Œå› æ­¤FTRåœ¨é‹ç®—æ™‚æ¯å€‹channelæœƒå†å¤šä¸€é …$P_{dis}$çš„maskingä½ç½®è³‡è¨Š(åŒ…å«è·é›¢èˆ‡æ–¹å‘)
            - æ­¤æ™‚çš„$P_{dis}$æ˜¯çµ•å°ä½ç½®è³‡è¨Šï¼Œä½†å¯é€énearest interpolationåˆ°å¤šæ¨£çš„å°ºåº¦ä¾†å¹«åŠ©è¨“ç·´ä¸åŒè§£æåº¦ä¸‹çš„ç›¸å°ä½ç½®é—œä¿‚
        4. åœ¨ç”¢ç”Ÿmasking directionsæ™‚ï¼Œä½¿ç”¨4å€‹ä¸åŒçš„äºŒå…ƒæ ¸å¿ƒä¾†å¾—åˆ°4-channelçš„one-hot vector $D_{dir}\in \mathbb{R}^{256\times256\times4}$
            1. $D_{dir}$çš„å€¼å–æ±ºæ–¼**å“ªä¸€å€‹kernelå…ˆè¦†è“‹åˆ°**masked region
            2. masking directionæ˜¯å€‹multi-label vectorï¼Œå› ç‚ºä¸€å€‹pixelå¯èƒ½æœ‰ä¸åªä¸€å€‹æœ€çŸ­çš„directionï¼Œå› æ­¤$D_{dir}$æœƒåœ¨æŠ•å½±åˆ°ä¸€å€‹ d ç¶­åº¦çš„ç‰¹å¾µç©ºé–“ï¼Œå…¶ç‰¹å¾µç©ºé–“çš„ç¶­åº¦æ˜¯ä¸€å€‹å¯å­¸ç¿’çš„è®Šæ•¸
            $W_{dir}\in \mathbb{R}^{4\times d}$ï¼ŒæŠ•å½±å¾Œçš„æœ€çµ‚æ–¹å‘ç‰¹å¾µç‚º
            $P_{dir}=D_{dir}\times W_{dir}\in\mathbb{R}^{256\times256\times d}$
        5. æœ€å¾Œåœ¨MPEå¾—åˆ°çš„$P_{dis}$å’Œ$P_{dir}$æœƒæ³¨å…¥è‡³FTRçš„ç¬¬ä¸€å±¤

![æˆªåœ– 2022-09-01 ä¸Šåˆ1.06.12.png](./ZITS/2022-09-01_1.06.12.png)

### Zero-initialized Residual Addition (ZeroRA)

<aside>
ğŸ’¡ æ­¤éƒ¨åˆ†ç‚ºæå‡ºä¸€å€‹GANè¨“ç·´ä¸Šçš„ä¸€å€‹å°æŠ€å·§ï¼Œä¾†ç›¡å¯èƒ½ç°¡åŒ–GANçš„è¨“ç·´

</aside>

- **å‹•æ©Ÿ**
    - å¢é‡è¨“ç·´ï¼ˆå¢åŠ æ›´å¤šè¼”åŠ©è¨Šæ¯ï¼‰å¯ä»¥éˆæ´»çš„æ”¹å–„åœ–åƒä¿®å¾©çš„æˆæ•ˆï¼Œè€Œåœ¨æ­¤è«–æ–‡ä¸­å¸Œæœ›å°‡æ•´é«”çµæ§‹çš„è³‡è¨Šè¦–ç‚ºä¸€ç¨®è¼”åŠ©è³‡è¨Šï¼Œä¾†é€²ä¸€æ­¥æ”¹å–„é è¨“ç·´çš„ä¿®å¾©æ¨¡å‹
    - æå‡ºZeroRAä¾†å–ä»£transformerä¸­çš„layer normalizationè¨ˆç®—
- **ZeroRAçš„æ¦‚å¿µ**
    - çµ¦å®šä¸€å€‹è¼¸å…¥ç‰¹å¾µ$x$ï¼Œè¼¸å‡ºåŸå§‹è¼¸å…¥åŠ ä¸Šä¸€å€‹åŠ æ¬Šå¾Œçš„skip connectionè¨ˆç®—ç‚º$x'$
    $x' =x+\alpha\ \cdot\ F(x)$
    - ç•¶è¨“ç·´å‰æœŸ$\alpha$é è¨­ç‚º0æ™‚ï¼Œè¼¸å…¥å’Œè¼¸å‡ºçš„é—œä¿‚ç‚ºç›¸åŒï¼Œå¦‚æ­¤**å¯ä»¥è®“è¨“ç·´è®Šå¾—ç©©å®š**
- **åœ¨æ­¤ç¯‡è«–æ–‡çš„æ‡‰ç”¨**
    - ä½¿ç”¨ZeroRAä¾†æ¼¸é€²å¼çš„æ·»åŠ çµæ§‹è³‡è¨Šé€²FTRä¸­
    - 4å€‹zero-initialized $\alpha_k,k\in\{0,1,2,3\}$æ˜¯ç”¨ä¾†fuse 4å€‹ç›¸å°æ‡‰çš„feature maps $S_k$(ä¾†è‡ªSFE)
        
        ![æˆªåœ– 2022-09-01 ä¸Šåˆ2.12.20.png](./ZITS/2022-09-01_2.12.20.png)
        
- **ZeroRAçš„å„ªé»**
    - åœ¨finetuneæ™‚å¯ä»¥ä¿ƒä½¿ modelçš„è¼¸å‡ºèˆ‡pre-train modelçš„è¼¸å‡ºä¸€è‡´ï¼Œå¯ç¢ºä¿è¨“ç·´æ™‚çš„ç©©å®šæ€§

## 3.4 Loss Functions

![æˆªåœ– 2022-09-01 ä¸Šåˆ2.28.53.png](./ZITS/2022-09-01_2.28.53.png)

- **L1 Loss**
    - åªè¨ˆç®—æœªé®è”½å€åŸŸ â†’ ç¢ºä¿æœ‰ç­”æ¡ˆçš„åœ°æ–¹ä¸èƒ½å£æ‰ï¼Œå¿…é ˆä¸€æ¨¡ä¸€æ¨£
    - $L_{L1}=(1-M)\odot|\hat{I}-\tilde{I}|_1$
- **adversarial loss**
    - åŒ…å«discriminator loss $L_D$å’Œgenerator loss $L_G$
        
        ![æˆªåœ– 2022-09-01 ä¸Šåˆ2.21.14.png](./ZITS/2022-09-01_2.21.14.png)
        
        $L_{GP}$ç‚ºgradient penaltyç”¨ä¾†ä¿æŒGANè¨“ç·´ä¸­çš„ç©©å®š
        
    - åƒ…å°‡é®è”½å€åŸŸçš„ç‰¹å¾µè¦–ç‚ºå‡æ¨£æœ¬
    - Discriminator: PatchGANçš„discriminator
        
        ![æˆªåœ– 2022-09-01 ä¸Šåˆ2.20.26.png](./ZITS/2022-09-01_2.20.26.png)
        
    - Generator: FTR+SFE
        
        ![æˆªåœ– 2022-09-01 ä¸Šåˆ2.20.40.png](./ZITS/2022-09-01_2.20.40.png)
        
- **feature match loss**
    - åŸºæ–¼çœŸå‡æ¨£æœ¬é–“çš„discriminator featureçš„L1 loss
    - ä¹Ÿæ˜¯ç”¨ä¾†ç©©å®šGANçš„è¨“ç·´
- **high receptive field(HRF) perceptual loss**
    
    ![æˆªåœ– 2022-09-01 ä¸Šåˆ2.25.22.png](./ZITS/2022-09-01_2.25.22.png)
    
    - åœ¨[è«–æ–‡44](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9707077)ä¸­æåˆ°ç›¸å°æ–¼perceptual lossï¼ŒHRP lossæ›´èƒ½æå‡inpainting modelçš„å“è³ª

# 4. Experiments

## 4.1 Datasets

## 4.2 Implementation Details

## 4.3 Comparison Methods

## 4.4 Quantitative Comparisons

## 4.5 Qualitative Comparisons

## 4.6 Ablation Studies

## 4.7 Results of High-Resolusion Inpainting

# 5. Conclusion